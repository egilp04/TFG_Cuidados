<div class="w-full mb-4">
  <app-buttonback></app-buttonback>
</div>

<div class="flex flex-col items-center p-6 bg-surface">
  @if (this.messageService.messageData(); as data) {
  <div
    [ngClass]="{
      'text-red-500': data.tipo === 'error',
      'text-primary': data.tipo === 'exito'
    }"
    class="text-lg font-medium mb-6 transition-all duration-300 bg-white px-4 py-2 rounded-lg shadow-sm"
  >
    {{ data.mensaje }}
  </div>
  }
</div>

<div class="flex flex-col p-6 gap-4 mt-20 md:mt-120">
  <h2 class="text-primary text-h2 text-center">
    {{ 'MANAGEMENT_SCHEDULES.TITLE' | translate }}
  </h2>

  <div class="flex flex-col gap-20 px-10">
    <app-inputs
      name="time"
      [label]="'MANAGEMENT_SCHEDULES.FORM.START_TIME' | translate"
      type="time"
      [control]="getCtrl('hora')"
      step="1800"
    >
    </app-inputs>

    <div class="flex flex-col gap-1">
      <label class="text-label text-primary">
        {{ 'MANAGEMENT_SCHEDULES.FORM.DAY_LABEL' | translate }}
      </label>
      <div class="relative w-full">
        <select
          name="dia"
          [formControl]="getCtrl('dia')"
          class="text-label w-full p-4 rounded-12 border-2 border-primary bg-transparent text-primary outline-none focus:border-accent cursor-pointer transition-colors"
        >
          <option value="" disabled selected>
            {{ 'MANAGEMENT_SCHEDULES.FORM.SELECT_DAY' | translate }}
          </option>
          <option value="lunes">{{ 'MANAGEMENT_SCHEDULES.DAYS.MONDAY' | translate }}</option>
          <option value="martes">{{ 'MANAGEMENT_SCHEDULES.DAYS.TUESDAY' | translate }}</option>
          <option value="miercoles">{{ 'MANAGEMENT_SCHEDULES.DAYS.WEDNESDAY' | translate }}</option>
          <option value="jueves">{{ 'MANAGEMENT_SCHEDULES.DAYS.THURSDAY' | translate }}</option>
          <option value="viernes">{{ 'MANAGEMENT_SCHEDULES.DAYS.FRIDAY' | translate }}</option>
          <option value="sabado">{{ 'MANAGEMENT_SCHEDULES.DAYS.SATURDAY' | translate }}</option>
          <option value="domingo">{{ 'MANAGEMENT_SCHEDULES.DAYS.SUNDAY' | translate }}</option>
        </select>
      </div>
    </div>
  </div>

  <div class="flex gap-4 w-full justify-center items-center">
    <app-button
      [label]="
        (isEditing ? 'MANAGEMENT_SCHEDULES.FORM.SAVE' : 'MANAGEMENT_SCHEDULES.FORM.ADD') | translate
      "
      variant="primary"
      (click)="onSave()"
    >
    </app-button>

    @if (isEditing) {
    <app-button
      [label]="'MANAGEMENT_SCHEDULES.FORM.CANCEL' | translate"
      variant="secondary"
      (click)="resetForm()"
    >
    </app-button>
    }
  </div>
</div>

<div class="flex flex-col p-6 gap-4 mt-20">
  <h2 class="text-secondary text-h2 text-center">
    {{ 'MANAGEMENT_SCHEDULES.LIST.TITLE' | translate }}
  </h2>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z2 w-full">
    <ng-container matColumnDef="hora">
      <th mat-header-cell *matHeaderCellDef class="p-4 text-label text-primary">
        {{ 'MANAGEMENT_SCHEDULES.TABLE.TIME' | translate }}
      </th>
      <td mat-cell *matCellDef="let horario" class="p-4 text-label text-primary">
        {{ horario.hora }}
      </td>
    </ng-container>

    <ng-container matColumnDef="dia">
      <th mat-header-cell *matHeaderCellDef class="p-4 text-label text-primary">
        {{ 'MANAGEMENT_SCHEDULES.TABLE.DAY' | translate }}
      </th>
      <td mat-cell *matCellDef="let horario" class="p-4 text-label text-primary">
        {{ horario.dia_semana }}
      </td>
    </ng-container>

    <ng-container matColumnDef="acciones">
      <th mat-header-cell *matHeaderCellDef class="p-4 text-label text-primary text-center">
        {{ 'MANAGEMENT_SCHEDULES.TABLE.ACTIONS' | translate }}
      </th>
      <td mat-cell *matCellDef="let horario" class="p-4 text-label text-primary">
        <div class="flex justify-center items-center gap-2 p-10">
          <app-button
            [label]="'MANAGEMENT_SCHEDULES.TABLE.EDIT' | translate"
            variant="primary"
            (click)="onEdit(horario)"
          >
          </app-button>
          <app-button
            [label]="'MANAGEMENT_SCHEDULES.TABLE.DELETE' | translate"
            variant="secondary"
            (click)="onDelete(horario.id_horario!)"
          >
          </app-button>
        </div>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns" class="hover:bg-gray-50"></tr>
  </table>
</div>
